(function(t){function n(n){for(var r,o,s=n[0],c=n[1],u=n[2],f=0,d=[];f<s.length;f++)o=s[f],i[o]&&d.push(i[o][0]),i[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);l&&l(n);while(d.length)d.shift()();return a.push.apply(a,u||[]),e()}function e(){for(var t,n=0;n<a.length;n++){for(var e=a[n],r=!0,s=1;s<e.length;s++){var c=e[s];0!==i[c]&&(r=!1)}r&&(a.splice(n--,1),t=o(o.s=e[0]))}return t}var r={},i={1:0},a=[];function o(n){if(r[n])return r[n].exports;var e=r[n]={i:n,l:!1,exports:{}};return t[n].call(e.exports,e,e.exports,o),e.l=!0,e.exports}o.m=t,o.c=r,o.d=function(t,n,e){o.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,n){if(1&n&&(t=o(t)),8&n)return t;if(4&n&&"object"===typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(o.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var r in t)o.d(e,r,function(n){return t[n]}.bind(null,r));return e},o.n=function(t){var n=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(n,"a",n),n},o.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=n,s=s.slice();for(var u=0;u<s.length;u++)n(s[u]);var l=c;a.push([0,0]),e()})({0:function(t,n,e){t.exports=e("Vtdi")},Vtdi:function(t,n,e){"use strict";e.r(n);e("VRzm");var r=e("Kw5r"),i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("h1",[t._v("QSim JS")]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-7",attrs:{id:"codigo"}},[e("div",{staticClass:"form-group"},[e("button",{staticClass:"btn btn-info",on:{click:t.run}},[t._v("Ejecutar")]),e("button",{staticClass:"btn btn-info",on:{click:t.nuevoPrograma}},[t._v("Nuevo programa")])]),e("div",{staticClass:"form-group"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.codigo,expression:"codigo"}],staticClass:"form-control",attrs:{id:"codigo-text",rows:"30"},domProps:{value:t.codigo},on:{keyup:function(n){return("button"in n||!t._k(n.keyCode,"enter",13,n.key,"Enter"))&&n.ctrlKey?t.run(n):null},input:function(n){n.target.composing||(t.codigo=n.target.value)}}})])]),e("div",{staticClass:"col-sm-5",attrs:{id:"estados"}},[e("Registros",{attrs:{registros:t.estados.registros}}),e("Memoria",{attrs:{celdas:t.estados.memoria}}),e("Flags",{attrs:{flags:t.estados.flags}})],1)]),e("div",[e("h4",[t._v("Historial de intrucciones:")]),e("table",t._l(t.historialEjecucion,function(n){return e("tr",[e("td",[t._v(t._s(n.etiqueta?n.etiqueta+":":""))]),e("td",[t._v(t._s(n.instruccionStr))])])}))])])},a=[],o=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{attrs:{id:"registros"}},[e("h4",[t._v("Registros:")]),e("table",[t._m(0),t._l(t.registros,function(n,r){return e("tr",{key:r},[e("td",[e("strong",{staticClass:"text-primary"},[t._v(t._s(r)+":")])]),e("td",[t._v("\n                "+t._s(t._f("hexa")(n))+"    \n            ")]),e("td",[e("i",{staticClass:"text-info text-monospace",staticStyle:{float:"right"}},[t._v(" "+t._s(n)+" ")])]),e("td",[e("i",{staticClass:"text-info text-monospace",staticStyle:{float:"right"}},[t._v(" "+t._s(t._f("ca2Decimal")(n))+" ")])]),e("td",[e("i",{staticClass:"text-info text-monospace",staticStyle:{float:"right"}},[t._v(" "+t._s(t._f("bin")(n))+" ")])])])})],2)])},s=[function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("tr",[e("th"),e("th",[t._v("hexa")]),e("th",[t._v("naturales")]),e("th",[t._v("enteros")]),e("th",[t._v("binario")])])}],c=(e("a1Th"),e("9XZr"),e("TPa0"));function u(t,n,e,r){var i,a,o=Object(c["a"])(t),s=o.slice(0),u=Object(c["a"])(n),l=u.slice(0),f=0,d=[];while(s.length>0&&l.length>0)i=s.pop(),a=l.pop(),d.unshift(e(i,a,f)),f=r(i,a,f);return{resultado:d.join(""),carry:f}}function l(t,n){return u(t,n,function(t,n,e){return t^n^e},function(t,n,e){return t&n|(t^n)&e})}function f(t){return t.charAt(0)}function d(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16;return t.toString(2).padStart(n,"0")}function p(t){return parseInt(t,2)}function g(t){return"0"===f(t)?p(t):-1*p(h(t))}function h(t){var n=m(t);return l(n,"1".padStart(n.length,"0")).resultado}function m(t){var n=Object(c["a"])(t),e=n.slice(0);return e.map(function(t){return"0"===t?"1":"0"}).join("")}var v={name:"Registros",props:["registros"],filters:{hexa:function(t){return"0x"+t.toString(16).padStart(4,"0").toUpperCase()},bin:function(t){return d(t)},ca2Decimal:function(t){return g(d(t))}}},R=v,_=e("KHd+"),x=Object(_["a"])(R,o,s,!1,null,null,null),b=x.exports,O=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{attrs:{id:"memoria"}},[e("h4",[t._v("Memoria:")]),e("table",[t._m(0),t._l(t.celdas,function(n,r){return e("tr",{key:r},[e("td",[e("strong",{staticClass:"text-primary"},[t._v(t._s(r)+":")])]),e("td",[t._v("\n                "+t._s(t._f("hexa")(n))+"\n            ")]),e("td",[e("i",{staticClass:"text-info text-monospace",staticStyle:{float:"right"}},[t._v(t._s(n))])]),e("td",[e("i",{staticClass:"text-info text-monospace",staticStyle:{float:"right"}},[t._v(t._s(t._f("ca2Decimal")(n)))])]),e("td",[e("i",{staticClass:"text-info text-monospace",staticStyle:{float:"right"}},[t._v(t._s(t._f("bin")(n)))])])])})],2)])},E=[function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("tr",[e("th"),e("th",[t._v("hexa")]),e("th",[t._v("naturales")]),e("th",[t._v("enteros")]),e("th",[t._v("binario")])])}],M={name:"Memoria",props:["celdas"],filters:{hexa:function(t){return"0x"+t.toString(16).padStart(4,"0").toUpperCase()},bin:function(t){return d(t)},ca2Decimal:function(t){return g(d(t))}}},A=M,P=Object(_["a"])(A,O,E,!1,null,null,null),S=P.exports,y=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{attrs:{id:"flags"}},[e("h4",[t._v("Flags:")]),e("table",t._l(t.flags,function(n,r){return e("tr",{key:r},[e("td",[e("strong",{staticClass:"text-primary"},[t._v(t._s(r)+":")])]),e("td",[e("i",{staticClass:"text-info text-monospace",staticStyle:{float:"right"}},[t._v(t._s(n?1:0)+" ")])])])}))])},k=[],D={name:"Flags",props:["flags"]},C=D,w=Object(_["a"])(C,y,k,!1,null,null,null),J=w.exports,F=(e("OEbY"),e("pIFo"),e("KKXr"),e("xmWZ")),j=e("qpph"),N={modo:{registro:/^R[0-7]$/i,inmediato:/^0x[A-F|0-9]{4}$/i,directo:/^\[0x[A-F|0-9]{4}\]$/i,indirecto:/^\[\[0x[A-F|0-9]{4}\]\]$/i,indirectoRegistro:/^\[R[0-7]\]$/i},instruccion:{conEtiqueta:/^\w+:\s+/i,etiqueta:/^(.*):/i,operacion:/^(?:.*:\s*)?(\w{0,4})/i,destino:/\w+\s+(\[{0,2}\w+\]{0,2})\s*,\s*.*$/i,origen:/\s+(\[{0,2}\w+\]{0,2})$/i},comentario:/#.*/,parentesisExternos:/\[(.*)\]/};e("INYr");function V(t,n){var e=n.exec(t.trim());return e?e[1]:null}var I=function(t){return V(t,N.instruccion.etiqueta)},T=function(t){return V(t,N.instruccion.operacion)},U=function(t){return V(t,N.instruccion.destino)},L=function(t){return V(t,N.instruccion.origen)},B=function(t){return t.replace(N.instruccion.etiqueta,"").trim()};function $(t){return N.instruccion.conEtiqueta.test(t)}function q(t,n){return I(t)==n}function z(t,n){var e=t.findIndex(function(t){return $(t)&&q(t,n)});return e}function G(t){return N.modo.registro.test(t)?"registro":N.modo.directo.test(t)?"directo":N.modo.inmediato.test(t)?"inmediato":N.modo.indirecto.test(t)?"indirecto":N.modo.indirectoRegistro.test(t)?"indirectoRegistro":null}function H(t,n){switch(G(n)){case"registro":return{ubicacion:"registros",id:n,valor:t.registros[n]};case"directo":return{ubicacion:"memoria",id:n,valor:t.memoria[n]};case"inmediato":return{ubicacion:"instruccion",id:n,valor:parseInt(n)};case"indirecto":return K(t,n,"memoria");case"indirectoRegistro":return K(t,n,"registros");default:return n}throw alert("Se fue todo a la MIERDA con los OPERANDOS!!!!"),"Se fue todo a la MIERDA con los OPERANDOS!!!!"}function K(t,n,e){var r=X(n),i=t[e][r],a="[".concat(Z(i),"]");return H(t,a)}function X(t){return t.replace(N.parentesisExternos,"$1")}function Z(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;return"0X"+t.toString(16).toUpperCase().padStart(n,"0")}e("Z2Ku"),e("L9s1");function Q(t,n){var e={instruccionRaw:n,etiqueta:I(n),instruccionStr:B(n).toUpperCase(),operacion:T(n),destino:U(n),origen:L(n)};return e.operandoDestino=H(t,e.destino),e.operandoOrigen=H(t,e.origen),"NOT"==e.operacion&&(e.operandoDestino=e.operandoOrigen,e.operandoOrigen=null),e.errores=ot(e),e}var W=["MUL","MOV","ADD","SUB","DIV","AND","OR"],Y=["CALL","RET","JMP","JE","JNE","JLE","JG","JL","JGE","JLEU","JGU","JCS","JNEG","JVS"],tt=W.concat(Y,["CMP","NOT"]),nt=function(t){return!tt.includes(t)},et=function(t){return W.includes(t)},rt=function(t){return Y.includes(t)},it=function(t){return t<0||t>65535},at=function(t){return null==t?{msg:"Falta operando"}:it(t)?{msg:"".concat(t," fuera de rango. Debe ser una numero entre 0x0000 y 0xFFFF")}:null};function ot(t){var n=t.operacion,e=(t.destino,t.origen,t.operandoDestino),r=t.operandoOrigen,i=(nt(n)?[{msg:"".concat(n," no es una operacion valida.\nSe esperaba alguna de las siguientes:\n").concat(tt.join(", "))}]:et(n)?[at(e),at(r)]:"NOT"===n?[at(e)]:(rt(n),[])).filter(function(t){return null!=t});return i}var st=function(t){return t.errores.length>0},ct=function(t){return"RET"!=t.operacion&&Y.includes(t.operacion)},ut=function(){function t(){Object(F["a"])(this,t),this.programa=[],this.memoria={},this.registros={R0:0,R1:0,R2:0,R3:0,R4:0,R5:0,R6:0,R7:0},this.pc=0,this.sp=65519,this.pila=[],this.flags={z:!1,n:!1,c:!1,v:!1},this.historialPila=[],this.limiteHistorialPila=100,this.historialEjecucion=[]}return Object(j["a"])(t,[{key:"almacenar",value:function(t,n){this[t.ubicacion][t.id]=n}},{key:"incrementarPc",value:function(){this.pc++}},{key:"apilarPc",value:function(){this.pila.push(this.pc)}},{key:"desapilarPc",value:function(){return this.pila.pop()}},{key:"cambiarPc",value:function(t){this.pc=z(this.programa,t)}},{key:"hayMasInstrucciones",value:function(){return this.pc<this.programa.length}},{key:"proximaInstruccion",value:function(){return Q(this,this.programa[this.pc])}},{key:"agregarPcAlHistorialPila",value:function(){this.historialPila.push(this.pc)}},{key:"laPilaSeFueALaMierda",value:function(){return this.historialPila.length>this.limiteHistorialPila}},{key:"agregarInstruccionAHistorialEjecucion",value:function(t){this.historialEjecucion.push(t)}},{key:"cargarPrograma",value:function(t){this.programa=t.split("\n").map(function(t){return t.trim().replace(N.comentario,"").replace(",",", ").toUpperCase()}).filter(function(t){return""!=t})}},{key:"actualizarFlags",value:function(t,n,e){var r=function(t){return 65535&t},i=function(t){return Math.floor((32768&t)/32768)},a=function(t){return 0==i(t)},o=function(t){return 1==i(t)};this.flags={z:0==r(e),n:1==i(e),c:t-n>65535||t-n<0,v:o(t)&&a(n)&&a(e)||a(t)&&o(n)&&o(e)},console.log("resultado",t-n),console.log("FLAGS: ",this.flags.z,this.flags.n,this.flags.c,this.flags.v)}},{key:"existeEtiqueta",value:function(t){return z(this.programa,t)>=0}},{key:"toString",value:function(){return"\n\t\t\t".concat(this.programa,"\n\t\t\t").concat(this.registros,"\n\t\t\t").concat(this.memoria,"\n\t\t")}}]),t}();function lt(t,n,e){var r;switch(t){case"MUL":r=n*e;break;case"MOV":r=e;break;case"ADD":r=n+e;break;case"SUB":r=n-e;break;case"CMP":r=n-e;break;case"DIV":r=Math.floor(n/e);break;case"AND":r=n&e;break;case"OR":r=n|e;break;case"NOT":r=~n;break}return{resultado:65535&r}}function ft(t,n){var e=n.z,r=n.n,i=n.c,a=n.v;switch(t){case"JE":return e;case"JNE":return!e;case"JLE":return e||r^a;case"JG":return!(e||r^a);case"JL":return r^a;case"JGE":return!(r^a);case"JLEU":return i||e;case"JGU":return!i||e;case"JCS":return i;case"JNEG":return r;case"JVS":return a}}function dt(t,n,e){switch(n){case"JMP":t.cambiarPc(e);break;case"CALL":t.incrementarPc(),t.apilarPc(),t.cambiarPc(e);break;case"RET":t.pc=t.desapilarPc();break;default:ft(n,t.flags)?t.cambiarPc(e):t.incrementarPc()}}function pt(t){var n=new ut;n.cargarPrograma(t);while(n.hayMasInstrucciones()){var e=n.proximaInstruccion(),r=gt(n,e);if(r)return ht(r),n;mt(n,e)}return n}function gt(t,n){return t.laPilaSeFueALaMierda()?"Parece que la pila se fue a la mierda... ¿te mandaste un bucle infinito?":st(n)?'ERROR en "'.concat(n.instruccionStr,'"\n').concat(n.errores.map(function(t){return t.msg}).join("\n")):ct(n)&&!t.existeEtiqueta(n.origen)?'NO EXISTE LA ETIQUETA "'.concat(n.origen,'". ¡¡¡SE FUE TODO A LA MIERDA!!! ¡¡¡VAMOS A MORIR!!!'):null}function ht(t){alert(t),console.log("ERRORRRRRRRRRRRRRR:",t)}function mt(t,n){var e,r=n.operacion,i=n.destino,a=n.origen,o=n.operandoDestino,s=n.operandoOrigen;n.instruccionRaw;t.agregarInstruccionAHistorialEjecucion(n),console.log("ejecutarInstruccion -> ".concat(r," ").concat(i," ").concat(a));var c=!1;switch(r){case"MUL":case"MOV":case"ADD":case"SUB":case"DIV":case"AND":case"OR":e=lt(r,o.valor,s.valor),console.log("Destino:   ",o),console.log("Origen:    ",s),console.log("Resultado:",e);break;case"NOT":e=lt("NOT",o.valor),console.log("Destino:   ",o),console.log("Resultado:",e);break;case"CMP":var u=o.valor,l=s.valor,f=lt(r,u,l).resultado;t.actualizarFlags(u,l,f);break;default:t.agregarPcAlHistorialPila(),dt(t,r,a),c=!0,console.log("Etiqueta:    ",s)}return e&&t.almacenar(o,e.resultado),c||t.incrementarPc(),console.log("---------------------------------------------------"),t}var vt="# Segundo parcial - 26/06/18 - Tema 1\n# R0 -> PUNTAJE\n# R4 -> POSICION\n\n                 JMP main\n\njugar:           MOV R5, R6          # \n                 AND R5, 0xFF00      # \n                 CMP R5, 0xFF00      # si no es FOWARD\n                 JNE ver_si_es_back  # ver si es BACK\n\n                 MOV R5, R6          # almaceno en R5 la cantidad de\n                 AND R5, 0x00FF      # posiciones a SUMAR en R4\n\n                 ADD R4, R5          # actualizo R4\n\n                 JMP fin\n\nver_si_es_back:  MOV R5, R6          # \n                 AND R5, 0xBB00      # \n                 CMP R5, 0xBB00      # si no es BACK\n                 JNE ver_si_es_bonus # ver si es BONUS\n\n                 MOV R5, R6          # almaceno en R5 la cantidad de\n                 AND R5, 0x00FF      # la cantidad de posiciones a RESTAR en R4\n \n                 SUB R4, R5          # actualizo R4\n\n                 JMP fin\n\nver_si_es_bonus: MOV R5, R6          # si no es\n                 AND R5, 0xFF00      # BONUS\n                 CMP R5, 0x0000      # entonces\n                 JNE fin             # no hace nada\n\n                 ADD R0, R6          # actualizo R0. no hace falta \n                                     # aplicar mascara para BONUS\n\n                 JMP fin\n\nfin:             RET\n\nmain:            MOV [0xA000], 0xFF03 # 3 forward\n                 MOV [0xA001], 0xFF09 # 9 forward\n                 MOV [0xA002], 0x000A # +10 puntos\n                 MOV [0xA003], 0x000B # +11 puntos\n                 MOV [0xA004], 0xBB03 # 3 backward\n                 MOV [0xA005], 0xEE03 # no hace nada\n                 MOV [0xA006], 0x1111 # marca el fin\n\n                 MOV R1, 0xA000   # R1 -> apunta al inicio del arreglo\n\n                 MOV R0, 0x0000   # inicializo el contador de puntos\n                 MOV R4, 0x0000   # inicializo el contador de posiciones\n\nwhile:           CMP [R1], 0x1111 # si el contenido de la celda a la que apunta R1\n                 JE fin           # es 0x1111, termina de procesar el arreglo\n                 \n                 MOV R6, [R1]     # guardo en R6 el elemento actual\n\n                 CALL jugar       # proceso elemento\n\n                 ADD R1, 0x0001   # incremento puntero\n\n                 JMP while\n\nfin:             RET\n",Rt=r["a"].extend({data:function(){return{estados:new ut,codigo:vt,historialEjecucion:""}},methods:{run:function(){this.estados=pt(this.codigo),this.historialEjecucion=this.estados.historialEjecucion},nuevoPrograma:function(){this.estados=new ut,this.codigo=""}},components:{Registros:b,Memoria:S,Flags:J}}),_t=Rt,xt=Object(_["a"])(_t,i,a,!1,null,null,null),bt=xt.exports;r["a"].config.productionTip=!1,new r["a"]({render:function(t){return t(bt)}}).$mount("#app")}});
//# sourceMappingURL=app.4fdac763.js.map